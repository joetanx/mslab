## 1. SecOps Overview

### 1.1. Key SecOps Functions

At a high level, an SOC is responsible for three key activities: monitoring, detection, and response.

These activities are interrelated and crucial to the success of the SOC's mission.

#### 1.1.1. Monitoring

Continuous monitoring of an organization's networks, systems, and applications to detect potential security incidents is what monitoring entails.

Examining logs, analyzing network traffic, and reviewing alerts generated by various security technologies may all be part of this process.

Monitoring's goal is to detect potential threats and vulnerabilities as soon as possible so that the SOC team can take action to prevent or mitigate the impact of a security incident.

#### 1.1.2. Detection

Detection entails analyzing data collected during monitoring to determine whether or not a security incident has occurred.

Analyzing log files, reviewing network traffic, and using threat intelligence to identify known attack patterns may all be part of this process.

When a security incident is discovered, it must be investigated to determine the extent of the damage and the steps required to correct the problem.

Following the resolution of the incident, recommendations must be made to prevent similar incidents from occurring in the future.

The goal of detection is to identify security incidents as quickly as possible so that the SOC team can take corrective action.

#### 1.1.3. Response

Once a security incident has been detected, response entails taking action to contain and remediate it.

It may be necessary to isolate affected systems, remove malware, and restore systems to a secure state.

The goal of response is to minimize the impact of a security incident and quickly restore normal operations.

For example, if a system is infected with ransomware, the response could include disconnecting the system from the network, quarantining the system, removing the ransomware, and restoring the system to its original state.

### 1.2. Challenges in SecOps

#### 1.2.1. Alert fatigue

Various security tools across network, endpoint, application and cloud security can generate thousands of alerts daily.

The rapid increase in volume can become overwhelming and contribute to alert fatigue, where analysts may overlook important alerts due to the background noise of **false positives** and **low-priority** alerts. 

This can result in analysts missing critical signals due to the overwhelming volume of alerts they must sort through, leading to severe security vulnerabilities if an alert is overlooked.

#### 1.2.2. Lack of skilled personnel

There is already a severe ever-growing skills gap in the cybersecurity industry, and security operations requires more qualified professionals with the skills needed to evaluate intricate security events, respond to incidents, and administer advanced security tools.

This shortage puts a strain on the existing workforce, an already understaffed SOC team may need help to keep up with the overwhelming volume of alerts generated by their security tools, possibly leaving critical events going undetected and the organization vulnerable to cyber threats.

This results in decline in morale and possible burnout as employees are overwhelmed and unable to keep up with the increasing responsibilities.

#### 1.2.3. Evolving threat landscape

Attackers are consistently using more sophisticated methods to bypass security defenses.

SOC analysts struggles to remain current on the most recent threats, vulnerabilities, and attack techniques.

This is exacerbated by the proliferation of newly developed technologies like cloud computing, the Internet of Things (IoT), and ML, each introducing new potential attack vectors.

#### 1.2.4. Tools integration

A typical cyber defense arsenal comprises a myraid of security tools across network, endpoint, application and cloud security for monitoring and response.

These tools needs to be integrated to correlate data and obtain a unified view of the security posture.

Integration difficulties can impede effective response and cause visibility gaps.

#### 1.2.5. Incident response time

Prompt response to security incidents is paramount for mitigating losses.

However, due to factors such as alert saturation, a lack of automation, and process inefficiencies, detection and response can be delayed.

Delayed response times means giving attackers plenty of time to move laterally within the network and possibly failing SLA compliance.

#### 1.2.6. Maintaining compliance

Organizations are subject to various regulations depending on their industry, such as GDPR/PDPA for data privacy, PCI DSS for credit card security, or CCOP for CII systems.

Ensuring compliance with these regulations while managing security operations is a challenging balancing act for SOC analysts.

#### 1.2.7. Lack of context

Security alerts by itself lack the context analysts need to make informed decisions.

Without understanding the broader context of an alert, such as the assets involved, their criticality, and their relationship to the overall business operations, analysts may not be able to prioritize and respond effectively, and identify patterns or trends in the data that might offer valuable insights.

#### 1.2.8. Limited budget

Resources are finite and SOCs usually operate with a limited budget; this restricts the ability to invest in modern technology, employ qualified personnel, and provide ongoing staff training.

This may result in inefficiency and reduced effectiveness within the SOC.

### 1.3. SecOps team structure

#### 1.3.1. Alert Analysts (Tier 1)

- First line of defense in SOC operations.
- Monitor and analyze security alerts from various tools (SIEM, IDS/IPS, firewalls).
- Perform initial triage, validate alerts, and escalate genuine threats to Tier 2.
- Maintain documentation and update incident records.

#### 1.3.2. Incident Responders (Tier 2)

- Handle escalated security incidents from Tier 1.
- Investigate security breaches, analyze malicious activities, and coordinate response efforts.
- Contain and remediate threats while minimizing business impact.
- Conduct forensic analysis and produce detailed incident reports.
- Perform preliminary forensic analysis by reviewing logs and alerts to identify suspicious activity.

#### 1.3.3. Threat Hunters (Tier 3)

- Handle escalated security incidents from Tier 2.
  - Conduct in-depth forensic investigations such as file analysis, malware reverse-engineer on compromised systems to uncover attacker methodologies.
  - Correlate forensic findings with threat intelligence to predict future attack trends.
- Proactively search for hidden threats within the network.
- Utilize threat intelligence and advanced analytical tools to detect anomalous behavior.
- Develop hunting methodologies to uncover sophisticated attacks like APTs (Advanced Persistent Threats).
- Work closely with Incident Responders and SOC Engineers to improve detection capabilities.

#### 1.3.4. SOC Engineers (and SOC Architects)

- Design, implement, and maintain SOC infrastructure and security tools.
- Ensure optimal configuration of SIEM, EDR, SOAR, and other security technologies.
- Develop automation and playbooks for efficient security monitoring and response.
- Continuously improve SOC performance and resilience through upgrades and optimizations.

#### 1.3.5. SOC Managers

- Lead and oversee SOC operations and strategy.
- Define policies, workflows, and security protocols.
- Ensure alignment with regulatory requirements and cybersecurity best practices.
- Coordinate communication between SOC and other departments (IT, legal, compliance).
- Manage team performance, training, and resource allocation.

### 1.4. SecOps technologies

An SOC typically employs a variety of technologies and processes to support these activities. These could include:

#### 1.4.1. Security Information and Events Management (SIEM)

SIEM platform is the Central Intelligence Hub that collects, analyzes, and correlates security event data from various sources to detect potential threats. It serves as the foundation for visibility and incident detection. It provides real-time monitoring, forensic analysis, and alerting based on predefined rules and machine learning models.

#### 1.4.2. Security Orchestration, Automation and Response (SOAR)

SOAR integrates with various security tools to automate repetitive security tasks or orchestrate incident response actions such as threat containment and remediation across different tools. Its augments the security operations team performance by reducing response time and improving efficiency.

#### 1.4.3. Threat Intelligence Platform (TIP)

TIP integrates with SIEM and SOAR to provide contextual insights on emerging threats, helping security teams prioritize incidents based on real-world intelligence.

It enhances detection and helps organizations proactively identify and mitigate threats.

#### 1.4.4. Network Security: Intrustion Detection and Prevention Systems (IDPS), Network Detection and Response (NDR) and Network Traffic Analysis (NTA)

Network security technologies analyze network traffic to protects the network.

They continuously monitor network behavior to identify anomalies, such as lateral movement or command-and-control traffic.

Alerts from IDPS can be fed into SIEM for further investigation.

#### 1.4.5. Extended Detection and Response (XDR) - including EDR and NDR

XDR enhances traditional endpoint and network security by integrating data across multiple security layers.

It provides broader threat visibility and automated incident response across endpoints, networks, and cloud environments.

#### 1.4.6. Cloud Native Application Protection Platform (CNAPP)

CNAPP provides comprehensive security for cloud workloads, integrating Cloud Infrastructure Entitlement Management (CIEM), Cloud Security Posture Management (CSPM), and Cloud Workload Protection Platform (CWPP) to improve security posture and secure identities, configurations, and workloads in cloud environments.

#### 1.4.7. Vulnerability Management (VM)

VM solutions continuously scan and assess assets to identify security weaknesses. They prioritize vulnerabilities based on severity and potential impact, helping organizations remediate risks before exploitation.

#### 1.4.8. External Attack Surface Management (EASM)

EASM continuously scans and and secures externally exposed assets, such as cloud services, web applications, and third-party integrations.

It helps security teams understand their attack surface and identify misconfigurations and exposed assets that could be exploited by attackers.

## 2. Incident Response

### 2.1. Attack Lifecycle

Frameworks for analyzing cyber attack timelines:
- **Cyber Kill Chain**: seven-step model that outlines the typical stages of a cyber attack 
- **MITRE ATT&CK**: detailed matrix of tactics, techniques and procedures (TTP) used by adversaries

| Cyber Kill Chain Phase | MITRE ATT&CK (Enterprise) Tactics | Description |
|---|---|---|
| Reconnaissance | Reconnaissance | The attacker learns details about the target, including its IP address, network structure, and security measures. The attacker find weaknesses from reconnaissance data that can be used in the attack. |
| Weaponization | Resource Development | The attacker proceeds to weaponization after it has obtained enough knowledge of the victim. The attacker generates a malicious payload, such as a virus or worm, to take advantage of weaknesses found during the reconnaissance phase. |
| Delivery | Initial Access | The malicious payload is delivered to the victim, typically using phishing techniques such as email attachment or a website exploit. |
| Exploitation | Execution | If the delivery is successful, the payload will execute on the target and obtain access to internal systems. The attacker uses flaws in the systems establish a foothold. |
| Installation | Persistence,<br>Privilege Escalation | After initial access is obtained, the attacker establishes persistence mechanism such as backdoors to maintain access. |
| Command & Control | Command and Control | After a stable access is obtained, the attacker establishes remote control to compromised systems, typically via C2 and DGA techniques. |
|  | Defense Evasion,<br>Credential Access,<br>Discovery,<br>Lateral Movement | The attacker attempts to crawl deeper into the environment to seek valuable assets.<br>The Cyber Kill Chain does not explicitly define Lateral Movement as a separate step, it generally occurs after the initial breach when attackers seek to expand their access within the network. |
| Actions on Objectives | Collection,<br>Exfiltration,<br>Impact | The final goal where the attacker can achieve its objectives (e.g. monetary gains, reputation damage or political), typically:<br>• data theft - selling stolen data (monetary)<br>• system disruption - e.g. ransomware (monetary), denial of service (reputation damage or political)|

### 2.2. Incident Response Lifecycle

NIST SP 800–61 Revision 2 provides a structured approach to developing and implementing an efficient computer security incident response program.

It outlines a four-phase incident response process:

![](https://axaxl.com/fast-fast-forward/articles/-/media/axaxl/images/fast-fast-forward/2020/cyberincidentresponsecycle_axa-xl_graphic2.png)

#### 2.2.1. Phase 1: Preparation

Preparation focuses on readiness and involves setting up the foundation for effective incident response. Organizations establish policies, train personnel, and implement security measures to detect and handle potential threats.

- Developing and maintaining an incident response plan (IRP)
- Defining roles and responsibilities within the response team
- Establishing communication protocols (internal and external)
- Conducting regular training and simulation exercises
- Ensuring tools, technologies, and access controls are in place

#### 2.2.2. Phase 2: Detection & Analysis

Once a security event occurs, swift detection and accurate analysis are crucial.

- **Detection**: Identifying potential security incidents through alerts, logs, user reports, and automated monitoring systems.
- **Triage**: Assessing the severity and impact of detected incidents, such as correlating anomalous sequences against attack behavioral profiles (TTPs), to prioritize response efforts.
- **Investigation and Analysis**: Digital forensics to determine the nature, scope, origin, and methods of the attack. This often involves examining logs, traffic, endpoints, and indicators of compromise (IOCs).

#### 2.2.3. Phase 3: Containment, Eradication & Recovery

After identifying the threat, the focus shifts to neutralizing its impact and restoring normal operations.

- **Containment**: Short-term and long-term measures to limit the incident's spread and impact (e.g., isolating affected systems).
- **Eradication**: Removing the root cause of the incident, such as malware, unauthorized access, or vulnerable configurations.
- **Recovery**: Restoring systems and services to normal operation, while ensuring that systems are clean and monitored for signs of reinfection.

#### 2.2.4. Phase 4: Post-Incident Analysis 

After the incident has been resolved, reviewing lessons learned strengthens future defenses.

- **Analyzing Root and Contributing Causes**: Identifying what caused the incident and any underlying weaknesses.
- **Incorporating Lessons into Upgrades**: Using findings to update security policies, tools, procedures, and training.
- **Informing Strategic Decision-Making**: Feeding insights into broader organizational risk management and planning.

## 3. Security Analytics

Build a mature SOC pipeline that evolves from basic detection to intelligent, adaptive defense

### 3.1. Capture Threats with Analytic Rules

Start by identifying known threats using analytic rules
- Use complex event processing to correlate signals like failed logins and privilege escalations
- Horizontal scalability ensures complete coverage across distributed nodes
- Enables near-real-time alerting vs batch processing delays

#### 3.2. Multistage Analytics for Attack Chains

Use layered analytics to detect multi-stage, stealthy attacks
- Combine rule-based, heuristic, and behavioral detection
- Identify full compromise chains (e.g., from ransomware network attempts to file encryption)
- Surfaces threats that evade single-rule systems

### 3.3. Visualize Data to Investigate Faster

Use dashboards and visualizations to highlight anomalies
- Security data are presented in easily consumable charts, graphs, and dashboards tailored to different user roles.
- Threat hunting involves exploring hypotheses to detect compromise indicators that evaded standard alerting.
- Flexible timeline navigations aid retrospective analysis across extensive event sequences.
- Pivot trees and other context-rich views simplify the interrogation of related entities.

### 3.4. Threat Intelligence for Deeper Context

- **Enhancing Detection Accuracy**: Threat intelligence integrates known malicious indicators—such as suspicious IP addresses, domains, or attack signatures—into security analytics. This helps analytics tools immediately recognize potential threats instead of relying solely on anomaly detection.
- **Providing Context for Investigations**: Enriching logs with threat intelligence increases situational awareness and reveals whether an observed behavior is linked to known attack campaigns, helping analysts prioritize cases efficiently. Threat intelligence can also help to reveal tactics, techniques, and procedures (TTPs) associated with threat actors, aiding in identifying multistage attacks.
- **Enabling Proactive Defense**: Rather than reacting to threats after they emerge, organizations can use intelligence-driven security analytics to anticipate risks. Organizations can use threat data to hunt for threats in the environment or adapt defense mechanisms to improve security analytics methodologies and defense strategies,

### 3.6. Behavioral Analytics (such as UEBA)

Profile user/entity behavior to detect subtle anomalies
- Traditional signature-based rules alone struggle to detect novel or stealthy techniques.
- Behavioral analytics applies ML to endpoint, network, and authentication activity, establishing normal baselines.
- Baseline is established as users and systems dynamically interact, refining expected patterns.
- Anomalies in these probabilistic models trigger alerts when significant statistical deviations emerge, such as unusual processes launching or abnormal data transfers.
- Tuning reduces false positives while surfacing hard-to-see compromised behaviors. Periodic retraining maintains accuracy as environments change over months.

### 3.7. Threat Modeling with Machine Learning

ML models on security data for deeper insights and pattern discovery
- **Supervised ML**: Logistic regression, decision trees, Naive Bayes — ideal for known patterns
- **Unsupervised ML**: Clustering, dimensionality reduction — great for discovering unknown anomalies
- **Reinforcement ML**: Future use in autonomous detection and simulation training

## 4. Security Automation

### 4.1. Objectives in Security Automation

##### 4.1.1. Operational Efficiency

- **Standardization**: Playbooks establish consensus-tested standard operating procedures (SOPs) for consistent handling of generic incident categories. This reduces variation in practitioner responses over time, even with staff turnover. Documented playbooks ensure institutional knowledge stays within the SOC versus leaving with departed team members.
- **Scalability**: With playbooks defining how automated orchestration platforms (Security orchestration, automation, and response (SOAR)) should react based on trigger conditions, a small team can manage responses to a high volume of incidents. Playbooks encoded in workflow automation engines allow near-infinite incident processing without manual human bottlenecks up to compute resource limits.
- **Knowledge retention**: Institutional response wisdom remains captured in playbooks even as team members come and go. Playbooks help transfer tribal knowledge to new hires more reliably than manual shadowing, given consistent encodings. This boosts team resilience against turnover.
- **Reduced workload**: Automation allows security tools to triage alerts, filter out false positives, and prioritize the most critical incidents for analysts to review. This reduces the time analysts spend sifting through irrelevant data and allows them to focus on high-priority threats. Studies have shown automation can reduce workload by 30–50%.

#### 4.1.2. Agile Threat Detection and Response

- **Speed**: Playbook steps allow critical containment and investigation actions to launch immediately through programmed workflows without delay from manual processes or analyst approval bottlenecks. Automated playbook steps like isolating infected hosts or disabling compromised accounts execute at computer speeds orders of magnitude faster than waiting for human direction. This rapid response is critical given that attacker dwell times inside networks continue to shrink.
- **Efficiency**: Common incident types consuming standard analyst tasks like collecting forensic artifacts, querying threat intel feeds, or updating tracking tickets can transition to automated playbook executions, freeing up analyst bandwidth to handle more complex scenarios requiring human judgment and adaptability. Where machine consistency provides value, playbook automation maximizes the ROI of analyst creativity.
- **Flexibility**: As threats evolve, playbooks can be updated centrally, and changes immediately propagate refined response procedures enterprise-wide through SOAR deployment. Playbook revision control and modular design accelerate keeping responses aligned to emerging attacker behaviors and infrastructure shifts.
- **Improved threat detection**: Machine learning (ML) and artificial intelligence (AI) technologies powering automation are well suited for detecting subtle patterns and anomalies that may indicate a threat but are difficult for humans to spot manually. Automated tools continuously monitor diverse data sources, applying learned patterns to detect even stealthy threats between scanning intervals. This improves detection coverage compared to rule-based or signature-based tools alone.
- **Faster response times**: Predefined playbooks and integrations allow automated response actions to rapidly contain threats without waiting for analyst review in some cases. Automation shortens the mean time to respond (MTTR) and contains actively exploiting threats before they can cause damage. Faster response enhances the overall security posture.
- **Reduced human errors**: Automated tools eliminate human factors like fatigue, distraction, or lack of expertise that can lead to errors in judgment or missed threats. Properly configured automation is less prone to accidental oversights or failures to follow protocol during security incidents. This improves overall consistency and accuracy.

#### 4.1.3. Compliance and Audit Readiness

- **Tracking KPIs**: Automates performance metrics like Mean Time to Detect (MTTD) and Mean Time to Respond (MTTR), providing real-time insights into security effectiveness.
- **Auditability**: Security automation ensures a complete audit trail of case management and response activities, enhancing compliance, accountability, and transparency. Detailed playbook logging tracks actions taken during incidents (who took what actions, when, and why), facilitating reviews, root cause analysis, and post-breach gap identification for process improvements and playbook remediation.

### 4.2. Automation Functions

#### 4.2.1. Alert Management & Prioritization

- **Triage and alert prioritization**: Automate initial alert processing, enrichment, scoring, duplication removal, and categorization to speed up assignation and investigation.
- **Orchestrating alert enrichment**: Integrate threat intelligence feeds and centralized asset management databases provides invaluable context, aiding accurate security event prioritization decisions. Analysts can quickly check indicators against aggregated industry observations about associated threat groups, ongoing global campaigns, malware code overlaps, and vulnerable software versions still in use across the infrastructure. This enrichment connects the dots between previously disjointed internal activities.
- **Escalation and notifications**: Standardize notifications to appropriate teams or individuals based on customizable rules accounting for factors like severity, categorization, and service level agreements (SLAs).

#### 4.2.2. Streamline Incident Response Workflows

- **Investigation and analysis**: Automate retrieval of data from EDR tools, security appliances, the SIEM, and other systems to quicken basic incident analysis so teams can focus on higher-value tasks.
- **Response playbook support**: Connect tools and platforms to provide comprehensive data inputs and the ability to trigger response actions outlined in SOC playbooks geared toward specific threats and incidents.
- **Automated containment**: Expedite frontline containment measures by categorizing affected device criticality, detection rule severity scores, known privilege levels already reached, and the type of data or applications impacted. Trigger containment actions including automatically disable user accounts, block suspicious IP addresses, isolate infected endpoints, roll back unauthorized system changes, disable remote access, and enact other rapid response steps according to established runbooks.

#### 4.2.3. Case Management & Collaboration

- **Case management and response activities documentation**: End-to-end orchestration workflows log all investigative and mitigation activities as structured case records, including timestamps, commands enacted, analyst notes explaining actions taken, interesting file attachments collected, and threat intelligence or vulnerability data referenced while working the event. Meticulously compiled incident records greatly aid subsequent caseload review for additional patterns, streamline detailed postmortem reporting for leadership, and provide measurable performance indicators around response efficiency critical for identifying budgetary and capability gaps.
- **Smoother technical handoffs**: When escalating complex incidents from one team to another (such as an SOC team transitioning an incident to forensics for further analysis), key data can be automatically passed between each group's respective tools rather than manually.
- **Automated ticket creation**: Automatically open tickets regarding security issues in service management platforms to streamline communication and assignment during incidents.

#### 4.2.4. Threat Hunting & Investigation

- **Threat hunting and identification**: Orchestrate threat intel gathering, correlation against historic data, and access to additional context from other tools to uncover advanced threats missed by preventative tools.
- **Data enrichment for threat hunting**: Orchestrate SIEM data correlation with enriched logs from endpoints, firewalls, domain name system (DNS) tools, and proxy appliances to uncover advanced threats.
- **Operationalize threat hunting**: SOARs provide an invaluable workflow automation backbone, allowing analysts to launch extensive hunt queries across the enterprise rather than just reacting to each alert in isolation. High-priority threat intelligence on novel attack tradecraft leaked from dark web sources or emerging sophisticated actor groups can be rapidly operationalized into enterprise-wide search, scan, and forensic procedures executed systematically across server logs, endpoint data, email stores, network traffic, and cloud infrastructure.

## 5. SOC Engineering

### 5.1. Multi-Tenant Architecture

Managing Sentinel across multiple tenants requires a structured approach to workspace planning and cross-tenant management.

#### 5.1.1. Sentinel Workspace Planning

- Each tenant typically has its own **Sentinel workspace** for isolating security data and alerts.
- Workspaces should align with governance structures, compliance requirements, and operational workflows.
- Centralized monitoring can be achieved through **cross-workspace querying**, allowing security teams to analyze logs across tenants.

#### 5.1.2. Azure Lighthouse Usage Scenarios

Azure Lighthouse facilitates **multi-tenant visibility and management** in Sentinel, enabling MSSPs (Managed Security Service Providers) and enterprises with multiple subsidiaries to:

- Monitor security **across all tenants centrally** while keeping data segregated.
- Create and deploy **standardized analytics rules, playbooks, and hunting queries** across tenants.
- Assign **fine-grained RBAC access** for administrators working across tenants.

### 5.2. Role-Based Access Control (RBAC) for Different Tenants

RBAC in Sentinel is enforced at the **Log Analytics workspace** level and via **Sentinel-specific roles**:

- **Security Reader**: View logs, alerts, and reports without making changes.
- **Security Operator**: Investigate and respond to incidents.
- **Security Administrator**: Manage security settings, configure alerts, and govern Sentinel architecture.
- **Contributor Roles**: Provide granular control over analytics rule management and incident handling.

For multi-tenant:

- Use **Azure Lighthouse + RBAC** delegation to assign roles per tenant scope.
- Group-based access mapping aligns with organizational units or MSSP client boundaries.

### 5.3. Data Retention for Analytic Logs & Long-Term Storage

**Default Analytic Log Retention**:
- First 31 days free, then configurable up to 730 days (2 years) for extra cost.
- Critical for rule correlation, hunting, and investigation.

**Long-Term Retention Strategies**:
- Archive logs to Azure Data Lake or Blob Storage for cheaper, cold storage.
- Use Diagnostic Settings to stream data from Log Analytics to storage accounts for regulatory compliance.
- Restore archived logs to a temporary workspace or query using Federated Search (see next).

### 5.4. Federated Search to Data Lakes

**Azure Monitor's Federated Search** enables querying:
- Data in Log Analytics + Azure Data Lake Storage Gen2 without importing it.
- Use KQL (Kusto Query Language) with external tables pointing to archived files.

Scenario Use Cases:
- Search old logs stored cheaply in Data Lake for forensic or legal investigations.
- Maintain analytics performance by separating hot (active) from cold (archived) data.

Tools:
- Azure Synapse or Microsoft Fabric for deeper analytics or BI integration.
- Custom Sentinel workbooks can integrate federated queries visually.

## 6. Performance Metrics (10. SOC Metrics and Performance Measurement)

> Besta SOC Book:
> 
> ```
> 10 SOC Metrics and Performance Measurement
> ├── Core Areas for SOC Metrics
> │   ├── Threat Detection Effectiveness
> │   ├── Incident Investigation Efficiency
> │   └── Incident Response Effectiveness
> └── Metrics for Evaluating Incident Response Effectiveness
>     ├── Detection Speed
>     └── Response Speed
> ```

- Reduced mean time to detect threats signals enhanced vigilance in identifying malicious post-compromise activities faster amid the noise.
- A lower mean time to respond denotes improved prioritization and promptness in initiating investigations when novel alerts sound.
- Faster mean time to contain verifies upgraded protocols blocking wider adversarial spread after initial confirmations.
- Higher true positive rates over false positives indicate properly tuned analytics with minimized alarm fatigue.
- Wider containment automation coverage supplemented by human effort was still essential.

## 7. Sentinel

### **1. Data Connectors**
Sentinel supports **data ingestion** from multiple sources:
- **Built-in Connectors**: Integrates with Microsoft services like Defender, Entra ID, and third-party solutions.
- **Custom Connectors**: Allows ingestion via APIs, Syslog, or Common Event Format (CEF).
- **Multi-Cloud Support**: Collects data from **AWS, Google Cloud, and on-prem environments**.

### **2. Analytics Rules**
Microsoft Sentinel provides various types of analytics rules to detect threats efficiently:
- **Scheduled Analytics Rules**: Run queries at predefined intervals to identify security threats.
- **Near-Real-Time (NRT) Rules**: Execute queries every minute for rapid detection.
- **Fusion Rules**: Use machine learning to correlate multiple signals and detect sophisticated multistage attacks.

### **3. Workbooks**
Workbooks provide **interactive dashboards** for security monitoring:
- **Custom Dashboards**: Create tailored visualizations for security insights.
- **Prebuilt Templates**: Use ready-made dashboards for common security scenarios.
- **Data Exploration**: Analyze security data using **KQL queries**.

### **4. Threat Intelligence**
Microsoft Sentinel integrates **threat intelligence** for proactive security:
- **Threat Intelligence Platform**: Ingests feeds from various sources.
- **STIX/TAXII Support**: Enables structured threat intelligence integration.
- **Indicator of Compromise (IoC) Matching**: Correlates IoCs with ingested logs.

### **5. Advanced Hunting**
Security teams can perform **deep investigations** using Sentinel’s hunting capabilities:
- **KQL Query Language**: Enables powerful queries for threat analysis.
- **Entity-Based Investigation**: Connects related alerts and logs for contextual analysis.
- **Live Response**: Allows direct interaction with endpoints for forensic analysis.

### **6. Incident Management**
Incident management in Sentinel helps security teams respond effectively:
- **Incident Creation**: Automatically groups related alerts into incidents for streamlined investigation.
- **Incident Investigation**: Provides a graphical view of alerts, entities, and logs for deeper analysis.
- **Incident Response**: Supports automation through playbooks and manual actions.

### **7. Security Automation**
Sentinel enables **automated security responses**:
- **Playbooks**: Automates responses using **Azure Logic Apps**.
- **SOAR Capabilities**: Enables automated threat mitigation workflows.
- **Custom Automation Rules**: Defines triggers for specific security actions.

### **8. Notebooks**
Notebooks enable **advanced threat hunting** and investigation:
- **Jupyter Notebooks Integration**: Perform deep forensic analysis using Python.
- **Machine Learning Capabilities**: Apply AI-driven analytics for threat detection.
- **Data Visualization**: Generate graphs and reports for security insights.

### **9. Security Copilot Integration**
Microsoft **Security Copilot** is an AI-powered assistant designed to enhance security operations by providing **incident summaries, threat intelligence, and automation capabilities**. It integrates with **Microsoft Sentinel** to streamline security workflows and improve threat detection.
- **Incident Summaries**: Uses AI to generate concise reports on security incidents, helping analysts quickly understand threats.
- **Natural Language to KQL**: Converts plain language queries into **Kusto Query Language (KQL)** for advanced threat hunting.
- **Automated Threat Investigation**: Assists security teams by analyzing alerts and suggesting next steps.
- **Security Copilot Agents**: AI-driven agents automate security tasks, such as phishing triage and vulnerability remediation.
- **Multi-Tenant Support**: Enables managed security service providers (MSSPs) to use Copilot across customer environments.

### **10. Multi-Workspace & Multi-Tenant Support**
Sentinel allows organizations to manage **multiple environments**:
- **Unified Security Operations**: Provides a single-pane view across multiple workspaces.
- **Cross-Tenant Visibility**: Enables security monitoring across different tenants.
- **Centralized Incident Management**: Streamlines security operations for large enterprises.

### **11. Customization & Extensibility**
Sentinel offers **flexibility** for security teams:
- **Custom Detection Rules**: Define tailored analytics rules.
- **Custom Dashboards & Reports**: Build personalized security views.
- **API Integration**: Extend Sentinel’s capabilities with third-party tools.

### **12. Cost Optimization**
Sentinel provides **cost-effective security operations**:
- **Pay-As-You-Go Pricing**: Flexible billing based on data ingestion.
- **Commitment Tiers**: Offers discounts for predictable workloads.
- **Cost Management Tools**: Helps optimize security spending.

### **13. Continuous Updates & Enhancements**
Microsoft Sentinel is **constantly evolving**:
- **Regular Feature Updates**: New capabilities are added frequently.
- **Integration with Microsoft Defender**: Expands security coverage.
- **Community-Driven Enhancements**: Benefits from user feedback and industry trends.

## 8. Advanced Security Information Model

https://learn.microsoft.com/en-us/azure/sentinel/normalization

### 8.1. Query time parsers

ASIM uses query time parsers to map existing data to the normalized schemas using [KQL functions](https://learn.microsoft.com/en-us/kusto/query/functions/user-defined-functions). Many ASIM parsers are available out of the box with Microsoft Sentinel. More parsers, and versions of the built-in parsers that can be modified can be deployed from the [Microsoft Sentinel GitHub repository](https://aka.ms/AzSentinelASim).

For more information, see [ASIM parsers](https://learn.microsoft.com/en-us/azure/sentinel/normalization-parsers-overview).

### 8.2. Ingest time normalization

Query time parsers have many advantages:
- They do not require the data to be modified, thus preserving the source format.
- Since they do not modify the data, but rather presents a view of the data, they are easy to develop. Developing, testing and fixing a parser can all be done on existing data. Moreover, parsers can be fixed when an issue is discovered and the fix will apply to existing data.

On the other hand, while ASIM parsers are optimized, query time parsing can slow down queries, especially on large data sets. To resolve this, Microsoft Sentinel complements query time parsing with ingest time parsing. Using ingest transformation the events are normalized to normalized table, accelerating queries that use normalized data.

Currently, ASIM supports the following native normalized tables as a destination for ingest time normalization:

- [ASimAuditEventLogs](https://learn.microsoft.com/en-us/azure/azure-monitor/reference/tables/asimauditeventlogs) for the [Audit Event](https://learn.microsoft.com/en-us/azure/sentinel/normalization-schema-audit) schema.
- ASimAuthenticationEventLogs for the [Authentication](https://learn.microsoft.com/en-us/azure/sentinel/normalization-schema-authentication) schema.
- [ASimDnsActivityLogs](https://learn.microsoft.com/en-us/azure/azure-monitor/reference/tables/asimdnsactivitylogs) for the [DNS](https://learn.microsoft.com/en-us/azure/sentinel/normalization-schema-dns) schema.
- [ASimNetworkSessionLogs](https://learn.microsoft.com/en-us/azure/azure-monitor/reference/tables/asimnetworksessionlogs) for the [Network Session](https://learn.microsoft.com/en-us/azure/sentinel/normalization-schema-network) schema
- [ASimWebSessionLogs](https://learn.microsoft.com/en-us/azure/azure-monitor/reference/tables/asimwebsessionlogs) for the [Web Session](https://learn.microsoft.com/en-us/azure/sentinel/normalization-schema-web) schema.

For more information, see [Ingest Time Normalization](https://learn.microsoft.com/en-us/azure/sentinel/normalization-ingest-time).

### 7.3. ASIM and the Open Source Security Events Metadata

ASIM aligns with the [Open Source Security Events Metadata (OSSEM)](https://ossemproject.com/intro.html) common information model, allowing for predictable entities correlation across normalized tables.

OSSEM is a community-led project that focuses primarily on the documentation and standardization of security event logs from diverse data sources and operating systems. The project also provides a Common Information Model (CIM) that can be used for data engineers during data normalization procedures to allow security analysts to query and analyze data across diverse data sources.

For more information, see the [OSSEM reference documentation](https://ossemproject.com/cdm/guidelines/entity_structure.html).
